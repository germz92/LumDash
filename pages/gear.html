  <h2 id="eventTitle" style="margin-bottom: 2px;"></h2>
  <h1>Gear Checklist</h1>

  <div class="gear-controls">
    <div class="top-controls">
      <div style="display: flex; gap: 16px; align-items: center;">
        <label for="checkoutDate">Check-Out Date:</label>
        <input type="date" id="checkoutDate" name="checkoutDate">
        <label for="checkinDate">Check-In Date:</label>
        <input type="date" id="checkinDate" name="checkinDate">
      </div>
      <div class="list-group">
        <label for="gearListSelect">Gear List:</label>
        <select id="gearListSelect"></select>
        <div class="list-controls">
          <button onclick="createNewGearList()" title="Create a new gear list">+ New List</button>
          <button onclick="deleteGearList()" style="background-color: #a1a1a1;" title="Delete the current gear list">üóëÔ∏è Delete</button>
        </div>
      </div>
      <button onclick="saveGearList()">üíæ Save</button>
      <label for="filterCheckbox" style="margin-left:16px;">Filter:</label>
      <select id="filterCheckbox">
        <option value="all">Show All</option>
        <option value="checked">Checked Only</option>
        <option value="unchecked">Unchecked Only</option>
      </select>
    </div>
    <!-- List description element -->
    <div id="listInfo" style="font-size: 14px; color: #666; margin-top: 4px; display: none;"></div>
  </div>

  <div class="gear-container" id="gearContainer"></div>
  <div id="gearStatusMessage" style="margin-top:10px; color: red;"></div>

  <!-- Modal for gear checkout selection -->
  <div id="checkoutModal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3 id="modalTitle">Select Item to Check Out</h3>
      <div id="modalItemList"></div>
      <button id="closeModalBtn" style="margin-top:18px; background:#a1a1a1;">Cancel</button>
    </div>
  </div>

  <div id="unavailableWarningModal" class="modal" style="display:none;">
    <div class="modal-content">
      <h3 style="color:#CC0007;">Unavailable Gear Warning</h3>
      <div id="unavailableWarningContent"></div>
      <div style="margin-top:18px; display:flex; gap:12px; justify-content:center;">
        <button id="unavailableProceedBtn" style="background:#cc0007;color:#fff;border:none;border-radius:8px;font-size:16px;padding:10px 24px;">Yes, proceed</button>
        <button id="unavailableCancelBtn" style="background:#a1a1a1;color:#fff;border:none;border-radius:8px;font-size:16px;padding:10px 24px;">Cancel</button>
      </div>
    </div>
  </div>

  <style>
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.25);
      justify-content: center;
      align-items: center;
    }
    .modal.show { display: flex; }
    .modal-content {
      background: #fff;
      border-radius: 18px;
      padding: 32px 24px;
      box-shadow: 0 8px 32px rgba(204,0,7,0.13), 0 2px 8px rgba(0,0,0,0.08);
      min-width: 320px;
      max-width: 95vw;
      text-align: center;
      animation: modalPopIn 0.28s cubic-bezier(.4,1.4,.6,1) both;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      margin: auto;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }
    @keyframes modalPopIn {
      0% { opacity: 0; transform: scale(0.96) translateY(30px); }
      100% { opacity: 1; transform: scale(1) translateY(0); }
    }
    .modal-content h3 {
      margin-top: 0;
      margin-bottom: 18px;
      font-size: 22px;
      color: #CC0007;
    }
    .modal-item-btn {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 14px;
      background: linear-gradient(90deg, #fff 60%, #f8fafd 100%);
      border: 1.5px solid #CC0007;
      border-radius: 10px;
      font-size: 17px;
      color: #000;
      cursor: pointer;
      transition: background 0.15s, border 0.15s;
    }
    .modal-item-btn:hover {
      background: #CC0007;
      color: #fff;
      border-color: #a30006;
    }
    #closeModalBtn {
      background: #a1a1a1;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      padding: 10px 0;
      width: 100%;
      margin-top: 18px;
      cursor: pointer;
      transition: background 0.15s;
    }
    #closeModalBtn:hover {
      background: #888;
    }
    .modal .modal-item-btn {
      color: #000;
    }
    .item button {
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 18px;
      padding: 0 4px;
      vertical-align: middle;
    }
    .list-controls {
      display: flex;
      gap: 8px;
    }
    .list-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .button-row {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      margin-bottom: 15px;
      justify-content: center;
    }
    .checkout-btn {
      background-color: #f0f0f0;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .checkout-btn:hover {
      background-color: #e0e0e0;
    }
    .add-btn {
      background-color: #f0f0f0;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .add-btn:hover {
      background-color: #e0e0e0;
    }
    
    /* Enhanced row styling */
    .item {
      display: flex;
      align-items: center;
      padding: 5px;
      margin-bottom: 2px;
      border-radius: 4px;
      transition: background-color 0.2s;
    }
    
    .item:hover {
      background-color: #f9f9f9;
    }
    
    .item[data-new-row="true"] {
      background-color: #f0f8ff;
      border-left: 3px solid #007bff;
    }
    
    .item input[type="text"] {
      flex: 1;
      padding: 6px 8px;
      margin: 0 5px;
      border: 1px solid #ddd;
      border-radius: 4px;
      transition: border-color 0.2s;
      width: 100%;
      box-sizing: border-box;
      text-overflow: ellipsis;
    }
    
    .item input[type="text"]:focus {
      border-color: #007bff;
      outline: none;
      box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
    }
    
    .item input[type="checkbox"] {
      margin-right: 8px;
      transform: scale(1.2);
    }
    
    /* Read-only mode styling */
    .read-only-mode .item {
      opacity: 0.9;
      background-color: #f9f9f9;
    }
    
    .read-only-mode .item input[type="text"] {
      border-color: transparent;
      background-color: transparent;
      cursor: default;
    }
    
    .read-only-mode .item input[type="text"]:focus {
      box-shadow: none;
      outline: none;
    }
    
    .read-only-mode .item input[type="checkbox"] {
      cursor: pointer;
    }
    
    .read-only-mode .item input[type="checkbox"] {
      opacity: 1;
      box-shadow: 0 0 2px rgba(0, 123, 255, 0.25);
    }
    
    /* Visual indicator for read-only mode */
    .read-only-mode::before {
      content: "üìã View Only";
      display: inline-block;
      position: absolute;
      top: 10px;
      right: 20px;
      padding: 5px 10px;
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      color: #6c757d;
      font-size: 14px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      z-index: 1;
    }
    
    /* Make gear container position relative for the view-only badge */
    #gearContainer {
      position: relative;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      box-sizing: border-box;
    }
    #modalItemList {
      max-height: 60vh;
      overflow-y: auto;
      margin-bottom: 15px;
      padding-right: 5px;
    }
    @media (max-width: 768px) {
      .modal-content {
        width: 90%;
        max-width: 90vw;
        padding: 20px 15px;
        margin: 10px;
      }
      
      #modalItemList {
        max-height: 50vh;
      }
    }
    
    /* Fix for delete buttons */
    .item button {
      color: #CC0007;
      font-size: 18px;
      background: #f8f8f8;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 2px 6px;
      margin-left: 8px;
      cursor: pointer;
      opacity: 1;
      flex-shrink: 0;
    }
  </style>

  <!-- Load config first -->
  <script src="../js/config.js"></script>

  <!-- Load scripts in sequence -->
  <script>
    function loadScriptsSequentially(scripts, index = 0) {
      if (index >= scripts.length) return;
      
      const script = document.createElement('script');
      script.src = scripts[index];
      
      script.onload = function() {
        loadScriptsSequentially(scripts, index + 1);
      };
      
      script.onerror = function() {
        console.error('Failed to load script:', scripts[index]);
        loadScriptsSequentially(scripts, index + 1);
      };
      
      document.head.appendChild(script);
    }
    
    // Load in this specific order
    loadScriptsSequentially([
      API_BASE + '/socket.io/socket.io.js', 
      '../js/socket.js',
      '../js/gear.js'
    ]);
  </script>
